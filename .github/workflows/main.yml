name: Criar nova branch

on:
  workflow_dispatch:

jobs:
  criar-nova-branch:
    runs-on: ubuntu-latest

    steps:
      - name: Selecionar branch
        uses: actions/github-script@v7.0.1
        with:
          script: |
            const branchName = github.event.inputs.branch_name;
            
            // Verifique se a branch existe
            const branchExists = await github.repos.getBranch({
              owner: github.repository_owner,
              repo: github.repository,
              branch: branchName
            });
            
            if (!branchExists) {
              // Crie a nova branch
              await github.repos.createBranch({
                owner: github.repository_owner,
                repo: github.repository,
                branch: branchName,
                // Use o secrets.GITHUB_TOKEN para autenticação
                token: ${{ secrets.GITHUB_TOKEN }}
              });
            } else {
              // A branch já existe
              console.log(`A branch ${branchName} já existe.`);
            }

      - name: Checkout na nova branch
        uses: actions/checkout@v4.1.2
        with:
          ref: ${{ github.event.inputs.branch_name }}